:%s/\(\d\+\)/0\&\1| |\1
ggVGg
:let @a=':g/:.*\d\+$/s/\(.*\):\(.*\) \(\d\+\)$/\1-\3:\2\r\1%\3:\2:g/[%-]/s/|\zs.*\ze|\(.*\):/\=eval(submatch(1))'
:let @b=':g/|[1-9].*|.*%/d:g/|-\d*|/d:%s?%?/?e'
:let @c=':%s?\d\+[-/]\d\+?\=eval(submatch(0))?e'
:let @l='/ :@a:@b:@c@l'
@l
:v/|0|[0,1]:/d
:%s/|.*/
:sort u
:%s/^\d\+&/+
:%j
:s/.*/\=eval(submatch(0))
